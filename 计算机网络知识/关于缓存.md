## 关于缓存



**CDN缓存:**

优势：

CDN节点解决了跨运营商和跨地域访问的问题，访问延时大大降低

大部分请求在CDN边缘节点完成，CDN起到了分流作用，减轻了源服务器的负载

缓存的过程：

cdn边缘节点缓存策略因服务商不同而不同，但一般遵循http标准协议，通过http响应头中的

```
Cache-control: max-age=36000
//Cache-control可设置项
max-age
no-cache：需要进行协商缓存，发送请求到服务器确认是否使用缓存。
no-store：禁止使用缓存，每一次都要重新请求数据。
public：可以被所有的用户缓存，包括终端用户和 CDN 等中间代理服务器。
private：只能被终端用户的浏览器缓存，不允许 CDN 等中继缓存服务器对其缓存。
Cache-Control 与 Expires 可以在服务端配置同时启用，同时启用的时候 Cache-Control 优先级高。
```



#### http缓存

#### 浏览器缓存

浏览器将http请求到的网络资源存储到内存里面

<img src="/var/folders/65/71xg97ds6hnc7_6xq9b987rh0000gp/T/com.yinxiang.Mac/WebKitDnD.ymsd2A/BF0C6892-D6BB-45AF-AC09-E1F15707EB6A.png" alt="BF0C6892-D6BB-45AF-AC09-E1F15707EB6A" style="zoom:50%;" />

##### 浏览器缓存分为“强缓存”和”协商缓存“

### 强缓存

浏览器在加载资源时，会先根据本地缓存资源的 header 中的Expires（绝对的失效时间字符串，这个容易出现偏差，通常都是设置Cache-Control来控制的） 和 Cache-Control（max-age相对时间，就是给定多少秒）判断是否命中强缓存，如果命中则直接使用缓存中的资源不会再向服务器发送请求。

**协商缓存**

当强缓存没有命中的时候，浏览器会发送一个请求到服务器，服务器根据 header（Last-Modify/If-Modify-Since （标识该资源的最后修改时间，根据资源的最后修改时间判断是否命中缓存）和 ETag/If-None-Match（返回的是一个校验码。ETag 可以保证每一个资源是唯一的，资源变化都会导致 ETag 变化。服务器根据浏览器上送的 If-None-Match 值来判断是否命中缓存。）） 中的部分信息来判断是否命中缓存。如果命中，则返回 304 ，告诉浏览器资源未更新，可使用本地的缓存