https://baijiahao.baidu.com/s?id=1730497790186462309&wfr=spider&for=pc

https://blog.csdn.net/m0_60237095/article/details/123656713

dns:dns称为域名系统（Domain Name System），其实就是将域名解析成ip，当我们在浏览器中输入一个域名，首先要将域名解析成ip地址，再将ip地址转换成mac地址（网络中每台设备都有一个唯一的网络标识，这个地址叫MAC地址或网卡地址）这样我们才能在网络上找到该服务器。当我们向dns服务器发起解析域名的请求时，dns服务器首先会查询自己的缓存中有没有该域名，如果缓存中存在该域名，则可以直接返回ip地址。如果缓存中没有，服务器则会以递归的方式层层访问。例如，我们要访问www.baidu.com，首先我们会先向全球13个根服务器发起请求，询问com域名的地址，然后再向负责com域名的名称服务器发送请求，找到baidu.com，这样层层递归，最终找到我们需要的ip地址。



cdn全程是内容分发网络(Content Distribution Network)，其目的是为了让用户能够更快速地请求到数据，通俗解释，cdn就是用来加速的，它能让用户更就近访问数据，这样能更快获取需要的数据。

举个例子，现在服务器在北京，深圳的用户想要获取服务器上的数据就需要跨越一个很远的距离，这显然就比北京的用户访问北京的服务器速度要慢。但是现在我们在深圳建立一个cdn服务器，上面缓存住一些数据，深圳用户访问时先访问这个cdn服务器，如果服务器上有用户请求的数据就可以直接返回，这样速度就大大的提升了。

cdn加速如何实现？

刚才说到cdn实际上是一个就近访问，那么现在有一个问题是，我们怎么知道用户的所在位置从而给他分配最佳的cdn节点呢。这就需要dns服务来进行定位了。当我们通过使用dns服务的时候，可以根据他使用的LDNS服务器来进行一个定位，例如我们的调度服务器看到他是来自深圳电信的LDNS服务器，那么我们就认为该用户来自深圳电信，然后调度服务器可以让该用户去访问深圳电信的CDN服务器，这样就让用户访问到了最优的cdn节点。
通过dns服务我们可以很快的定位到用户的位置，然后给用户分配最佳cdn节点，但是这种调度方式存在一个问题，例如，当我 是北京联通的用户但是使用的却是深圳电信的ldns的话，调度服务器会给我分配到深圳电信的cdn服务器，这样就产生了错误的调度。针对上面的问题，我们还有另一种调度方式——http调度。
当用户访问我们的服务器时，服务器先分析用户的ip地址，然后服务器给用户返回一个302重定向，将离用户最近的服务器存在location中，用户再去请求这个cdn服务器就能得到最佳的cdn节点。
这种调度方式的优点是他的定位更加准确，不会因为错误的ldns造成访问偏差。但是他的缺点就是需要一次额外的http访问，这样首次访问的延时就会比较高。所以如果是对大文件的请求，显然采用http的调度方式比较合适，因为大文件的请求需要更多的时间，相比之下可以忽略这次http请求的时间，但是如果是一些小文件的请求，花费这个时间有时就有些得不偿失了。
当然我们也可以将这两种方式结合起来使用，先通过dns的方式来定位，然后通过http的方式来纠正偏差。

cdn工作流程：

1.dns请求当地local DNS
2.当地local DNS递归的查询服务器的gslb
3.服务器根据local DNS 分配最佳节点，返回ip
4.用户获得最佳接入ip，访问最佳节点。
5.如果该节点没有用户想要获取的内容，则通过内部路由访问上一节点，直到找到文件或到达源站为止。
6.cdn节点缓存该数据，下次请求该文件时可以直接返回。



cdn加速原理：
1、缓存 (CDN缓存可以加快访问速度，也可以减少服务器的压力)
2、多个节点
3、多线路网络支持(可以跨网访问，如跨电信、联通和移动)