\### ç¬¬ä¸€ç«  --- Webpack æ¦‚å¿µ

webpack -- æ‰“åŒ…å·¥å…·ï¼ŒæŠŠæ–‡ä»¶åˆ†é—¨åˆ«ç±»è¿›è¡Œæ‰“åŒ…å’Œæ¸²æŸ“ï¼ŒåŠ é€ŸåŠ è½½é€Ÿåº¦å’Œå‡è½»æ‚¨çš„é¡¹ç›®çš„é‡é‡ã€‚è®©æ‚¨çš„é¡¹ç›®â€œé£â€èµ·æ¥



\#### 1.å…¥å£ï¼ˆentryï¼‰

<u> *å•ä¸ªå…¥å£è¯­æ³•ï¼š</u>



\```

const config = {

  entry:'./path/to/my/entry/file.js'

}



module.exports = config;

\```

<u> *æ•°ç»„è¯­æ³•ï¼š</u>



\```

const config = {

â€‹	entry:['./src/js/main.js','./src/js/other.js']

}

\```



<u> *å¯¹è±¡è¯­æ³•ï¼š</u>



æ‰©å±•æ€§èƒ½å¥½ï¼šå„ä¸ªä¾èµ–å½¼æ­¤åˆ†ç¦»ï¼Œäº’ç›¸ç‹¬ç«‹ï¼Œç”¨äºå°†å…³æ³¨ç‚¹(concern)ä»ç¯å¢ƒ(environment)ã€æ„å»ºç›®æ ‡(build target)ã€è¿è¡Œæ—¶(runtime)ä¸­åˆ†ç¦»ã€‚ç„¶åä½¿ç”¨ä¸“é—¨çš„å·¥å…·ï¼ˆå¦‚ webpack-mergeï¼‰å°†å®ƒä»¬åˆå¹¶ã€‚



\```

const config = {

  entry:{

â€‹    app:'./src/app.js',

â€‹    vendors:'src/vendors.js'

  }

}

\```



\#### 2.è¾“å‡º (output)

ä»‹ç»ï¼šé…ç½® output é€‰é¡¹å¯ä»¥æ§åˆ¶ webpack å¦‚ä½•å‘ç¡¬ç›˜å†™å…¥ç¼–è¯‘æ–‡ä»¶ã€‚æ³¨æ„ï¼Œ<font color=red size=3>å³ä½¿å¯ä»¥å­˜åœ¨å¤šä¸ªå…¥å£èµ·ç‚¹ï¼Œä½†åªæŒ‡å®šä¸€ä¸ªè¾“å‡ºé…ç½®ã€‚</font>

output é…ç½®æœ€ä½è¦æ±‚æ˜¯å°†å®ƒçš„å€¼è®¾ä¸ºå¯¹è±¡ï¼Œæ¶‰åŠåˆ°2ç‚¹ï¼šfilename å’Œ path



<u> *å•ä¸ªå…¥å£èµ·ç‚¹ï¼š</u>



\```

//æ­¤é…ç½®æ˜¯å°†ä¸€ä¸ªå•ç‹¬çš„bundle.jsæ–‡ä»¶

è¾“å‡ºåˆ°/home/proj/public/assetsç›®å½•ä¸­



const config = {

â€‹	output:{

â€‹		filename:'bundle.js',

â€‹		path:'/home/proj/public/assets'

â€‹	}

}

module.exports = config;

\```



<u>*å¤šä¸ªå…¥å£èµ·ç‚¹</u>



\```

// __dirnameæ˜¯æŒ‡å½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ç»å¯¹è·¯å¾„



const config = {

â€‹	entry:{

â€‹		app:'./src/app.js',

â€‹		search:'./src/search.js'

â€‹	},

â€‹	output:{

â€‹	//filename:''bundle.js'',

â€‹	//path:__dirname + '/dist' 

â€‹	//ä»¥ä¸Šä»£ç ä¼šæŠ¥é”™,å› ä¸ºå…¥å£æœ‰2ä¸ªå­—æ®µï¼Œé‚£ä¹ˆä¼šç”Ÿæˆ2ä¸ªChunk,outputçš„filenameå†™æ­»ï¼Œé‚£ä¹ˆä¸€ä¸ªåç§°ä¸å¤Ÿ2ä¸ªChunkä½¿ç”¨ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨[name]å˜é‡

â€‹	

â€‹	//æ­£ç¡®çš„å†™æ³•â†“

â€‹		filename:'[name].js',

â€‹		path:__dirname + '/dist' 

â€‹	}

}

\```

\### 3.æ¨¡å¼ ï¼ˆmodeï¼‰

ä»‹ç»ï¼šæä¾›modeé…ç½®æ˜¯ç”¨äºå‘Šè¯‰webpackä½¿ç”¨ç›¸åº”ç¯å¢ƒçš„å†…ç½®ä¼˜åŒ–ï¼Œmodeå±æ€§å¯ä»¥æ ‡è®°å½“å‰è¿è¡Œç¯å¢ƒï¼Œä¼šå°†nodeç¯å¢ƒçš„process.env.NODE_ENVè¿›è¡Œèµ‹å€¼  

 modeæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š  

\1. none  

2.development (å¼€å‘ç¯å¢ƒ)  

3.production (ç”Ÿäº§ç¯å¢ƒ)  

 

tips: è®¾ç½® NODE_ENV å¹¶ä¸ä¼šè‡ªåŠ¨åœ°è®¾ç½®mode ; å¦‚æœæ²¡æœ‰è®¾ç½®modeï¼Œwebpackä¼šå°†modeçš„é»˜è®¤å€¼è®¾ç½®ä¸º production





<u>* ä¸¤ç§è¯­æ³•ï¼š </u>



\```

// 1.åªåœ¨é…ç½®ä¸­æä¾›modeé€‰é¡¹ï¼š

module.exports = {

â€‹	mode:'production'

}



//2.ä» cil å‚æ•°ä¸­ä¼ é€’

webpack --mode = production

\```



\### 4.loader (æ¨¡å—è½¬æ¢å™¨)

loaderå¯ä»¥æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸ºwebpackèƒ½å¤Ÿå¤„ç†çš„æœ‰æ•ˆæ¨¡å—ï¼Œæˆä¸ºåº”ç”¨ç¨‹åºçš„ä¾èµ–å›¾ï¼Œï¼ˆå¹¶æœ€ç»ˆæ·»åŠ åˆ°bundleä¸­ï¼‰ã€‚ä¾‹å¦‚å°†reactä¸­çš„jsxè½¬æ¢æˆjsä»£ç ï¼Œå°†less,sassæ–‡ä»¶è½¬æ¢æˆcssæ–‡ä»¶



****ä½¿ç”¨loaderçš„ä¸‰ç§æ–¹å¼ï¼š****  



<u>1.é…ç½®ï¼ˆæ¨èä½¿ç”¨ï¼‰</u> 

<font size=1> åœ¨ webpack.config.js æ–‡ä»¶ä¸­æŒ‡å®š loader </font>  



ğŸŒ°è¯­æ³•ä¾‹å­ï¼š



\```

 module: {

  rules: [

   {

â€‹    test: /\.css$/,

â€‹    use: [

â€‹     { loader: 'style-loader' },

â€‹     {

â€‹      loader: 'css-loader',

â€‹      options: {

â€‹       modules: true

â€‹      }

â€‹     }

â€‹    ]

   }

  ]

 }

\```

<u>2.å†…è”</u>



å¯ä»¥åœ¨ import è¯­å¥æˆ–ä»»ä½•ç­‰æ•ˆäº â€œimportâ€çš„æ–¹å¼ä¸­æŒ‡å®šloader.ä½¿ç”¨ï¼å°†èµ„æºä¸­çš„loaderåˆ†å¼€ã€‚åˆ†å¼€çš„æ¯ä¸ªéƒ¨åˆ†ç›¸å½“äºå½“å‰ç›®å½•è§£æã€‚

é€šè¿‡å‰ç½®æ‰€æœ‰è§„åˆ™åŠä½¿ç”¨ !ï¼Œå¯ä»¥å¯¹åº”è¦†ç›–åˆ°é…ç½®ä¸­çš„ä»»æ„ loaderã€‚



\```

import Styles from 'style-loader!css-loader?modules!./styles.css';

\```



é€‰é¡¹å¯ä»¥ä¼ é€’æŸ¥è¯¢å‚æ•°ï¼Œä¾‹å¦‚ ?key=value&foo=barï¼Œæˆ–è€…ä¸€ä¸ª JSON å¯¹è±¡ï¼Œä¾‹å¦‚ ?{"key":"value","foo":"bar"}ã€‚





<u>3.å¯ä»¥é€šè¿‡ cli ä½¿ç”¨loader</u>



\```

//è¿™ä¼šå¯¹ .jade æ–‡ä»¶ä½¿ç”¨ jade-loaderï¼Œå¯¹ .css æ–‡ä»¶ä½¿ç”¨ style-loader å’Œ css-loaderã€‚



webpack --module-bind jade-loader --module-bind 'css=style-loader!css-loader'

\```



\### 5.plugins (æ’ä»¶)

ä»‹ç»ï¼šæ’ä»¶çš„ç›®çš„æ˜¯åœ¨äºè§£å†³loaderæ— æ³•å®ç°çš„å…¶ä»–äº‹,å¯ä»¥è®©wepackä¸°å¯Œèµ·æ¥ã€‚

ç”±äºæ’ä»¶å¯ä»¥æºå¸¦å‚æ•°/é€‰é¡¹ï¼Œä½ å¿…é¡»åœ¨ webpack é…ç½®ä¸­ï¼Œå‘ plugins å±æ€§ä¼ å…¥ new å®ä¾‹



ğŸŒ°è¯­æ³•ä¾‹å­ï¼š



\```

const config = {

â€‹	entry:{ .........	//çœç•¥ },

â€‹	output:{ .........	//çœç•¥ },

â€‹	module:{ .........	//çœç•¥ },

â€‹	plugins:[

â€‹		new wepback.optimize.UglifyJsPlugin()

â€‹		new HtmlWebpackPlugin({template:'./src/index.html'})

â€‹	]

}



module.export = config;

\```

\###6. modules (æ¨¡å—)

webpack é€šè¿‡ loader å¯ä»¥æ”¯æŒå„ç§è¯­è¨€å’Œé¢„å¤„ç†å™¨ç¼–å†™æ¨¡å—ã€‚loader æè¿°äº† webpack å¦‚ä½•å¤„ç† é JavaScript(non-JavaScript) _*æ¨¡å—*_ï¼Œå¹¶ä¸”åœ¨ bundle ä¸­å¼•å…¥è¿™äº›ä¾èµ–ã€‚ webpack ç¤¾åŒºå·²ç»ä¸ºå„ç§æµè¡Œè¯­è¨€å’Œè¯­è¨€å¤„ç†å™¨æ„å»ºäº† loaderï¼ŒåŒ…æ‹¬ï¼š



CoffeeScript  

TypeScript 

ESNext (Babel)  

Sass  

Less  

Stylus  